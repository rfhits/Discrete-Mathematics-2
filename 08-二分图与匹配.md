# 二分图和匹配

## 参考资料

[匈牙利算法-CSDN](https://bog.csdn.net/u013384984/artice/detais/90718287)

## 二分图

### 定义

设G=<V,E>是一个无向图，如果将V划分为两个子集V1和V2，使得同一子集中的任何两个顶点都不邻接，则称图G为一个二分图，子集V1和V2称为G的互补子集。

### 定理

G 是一个二分图，当且仅当非平凡无向图G 的所有圈的长度都是偶数。

也就是说，我们只要找到一个圈的长度是奇数，就可以判定它不是而分图。

比如，五边形不是二分图。

## 匹配

设 G=⟨V,E⟩ 是一个二分图，如果E的一个子集 M中的任何两条边都不相邻，则称 M为二分图G的一个匹配。

通俗的说，图G的一个**匹配**是一个边集，这些边都很听话地落在那两个子集里，并且不接连。

匹配就是尽可能一一对应，没对上没关系，一夫一妻就行。

被一夫一妻的叫做饱和顶点，没被一夫一妻的叫做非饱和顶点。

[很好的解析](https://bog.csdn.net/u013384984/artice/detais/90718287)

## 最大匹配

在二分图G的所有匹配中, 边数最多的匹配称为G的最大匹配。

如果真的给出n个帅气的男孩，n个漂亮的女孩，他们之间互相有好感，但一个男孩可以对多个女孩有感觉，一个女孩也可能觉得多个男孩看起来都不错，在这种情况下，我们怎么让他们都能成双成对呢？

将这个问题抽象出来，互有好感就是一条条无向边（单相思我们先不考虑），而男孩和女孩就是一个个节点，我们构建出这么一个图，而完美匹配就是让所有看对眼的男孩和女孩都能够在一起。

完美匹配是最好的情况，也是我们想要的情况。

当然，有些情况下我们做不到完美匹配，只能尽可能实现最多的配对，这个就叫做最大匹配。

### 交错和增广

交错路径：给定图G的一个匹配M，如果一条路径的边交替出现在M中和不出现在M中，我们称之为一条**M-交错路径**。

增广路径：而如果一条M-交错路径，它的两个端点都不与M中的边关联，我们称这条路径叫做**M-增广路径**。

就是交错路径两边单着。

交错链（交错路径）：设M是二分图G的一个匹配。如果G中有这样一条基本链，链中任何相邻的两条边中恰有一条属于M，则称这样的链为关于M的交错链。

可扩充链（M-增广路径）：若一条交错链的两个端点是M的非饱和顶点，则称该交错链为关于M的可扩充链 (M -augmenting path)。

### 定理

设M是二分图G的一个匹配，当且仅当G中不存在关于M的可扩充链时，M是G的最大匹配。

### 匈牙利算法

最大匹配：匈牙利算法

1. 任取一个匹配𝑀（可以从空集或一条边开始）
2. 令 𝑆 是非饱和点（尚未匹配的点）的集合；
3. 如果 𝑆=∅ ，则𝑀已经是最大匹配；
4. 否则，从 𝑆 中取出一个非饱和点 𝑢_0 作为起点，从𝑢_0开始找到交错链 𝑃 ；
5. 如果 𝑃 是可扩充链，则令𝑀=(𝑀∪𝑃)−(𝑀∩𝑃)
6. 如果 𝑃 都不是可扩充链，则去掉𝑢_0，回到第3步

简而言之，从一个边开始，穷举非饱和点，找可扩充链。

## 从X到Y的匹配

从X到Y的匹配：如有二分图G的匹配M，使得**X的每一个顶点都是饱和**的，则称M为从X到Y的匹配。

若存在从X到Y的匹配，则应该满足#X≤#Y。

若M为是从X到Y的匹配，则M是二分图G的最大匹配。

### 相异性条件

设G是一个具有互补顶点子集X和Y的二分图。当且仅当对于X的任意子集U，#Γ(U)≥#U被满足时，存在G的从X到Y的匹配。


通俗地说，G中存在X到Y的匹配，当且仅当X中任意k个顶点(k＝1,2,…, #X)至少邻接Y中的k个顶点。该定理中所述的G中存在从X到Y的匹配的**充分必要条件**，常称为相异性条件。

> 就比如说，我从X随便挑3个点，都能邻接到Y中的三个点。
>
> 随便挑n个点，都能邻接到Y中n个点。
>
> **不存在**挑n个X对应不到n个Y的情况。

证明：

首先证，若存在G的从X到Y的匹配,则#Γ(U)≥#U被满足。

若存在从X到Y的匹配，则对X中的任一顶点，在Y中至少有一个邻接点；对X中任意两个不同顶点，在Y中至少有两个不同的邻接点，如此下去，对于X的任何子集U，Y中至少有#U个顶点与U的顶点邻接，所以#Γ(U)≥#U成立，即相异性条件被满足。

反之，若G满足相异性条件，则可以按如下方法构造出从X到Y的匹配。先任意找G中一个匹配M作为初始匹配，不妨设M还不是从X到Y的匹配。

于是，X中至少有一个非饱和顶点$x_0$。根据相异性条件，Y中一定存在与$x_0$邻接的顶点$y_i$，

如果$y_i$是非饱和顶点，则边$(x_0, y_i)$构成可扩充链，马上可以将边$(x_0, y_i)$加到匹配中使$x_0$变成饱和顶点。

如果Y中与$x_0$邻接的顶点全是饱和顶点，设为$y_{01}, y_{02},..., y_{0k}$，共k个，这时可以构成k条以x_0开始的交错链。可以证明，这k条交错链中至少有一条，它的终点是Y中的非饱和顶点，证明如下：


如果不然，这k条交错链的终点都是X中的饱和顶点，这样若令这些链上属于X的顶点集合为U，则Γ(U)也全由这些链上属于Y的顶点构成，于是#Γ(U)<#U,与相异性条件矛盾。

从而存在交错链$(x_0,y_{0i},…,y_i)$是一条可扩充链。然后，我们对匹配M进行调整，使$x_0$成为饱和顶点。重复上述过程，直至X的顶点全部成为饱和顶点，便得到从X到Y的匹配。

定理14.3充分性的证明，实际上提供了求从X到Y的匹配的算法。

### t条件

设G是具有互补顶点子集X和Y的二分图。如果能找到一个正整数t，使得对X的任意顶点x有d(x)≥t，对Y的任意顶点y有d(y)≤t，则图G存在从X到Y的匹配。定理中的条件称为“ t条件”

证明

对于X的任意子集U，设#U=r。因为对X的任意顶点x有d(x)≥t，所以至少有rt条边与子集U的顶点关联，对于Y的每一顶点y，都有d(y)≤t，所以，rt条边至少与Y中的r个顶点相关联，即#U≤#Γ(U)。

根据定理14.3，存在从从X到Y的匹配。

